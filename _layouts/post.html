<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>{{ page.title }} | Pawe≈Ç Basiak - Web Designer, Front end developer</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="apple-touch-icon" href="apple-touch-icon.png">
        <!-- Place favicon.ico in the root directory -->

        <link rel="stylesheet" href="{{ site.url }}/css/screen.css">
        <link rel="stylesheet" href="{{ site.url }}/css/styles.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

        <script src="/js/modernizr-custom.js"></script>
    </head>
    <body class="default-tpl single-portfolio {{ page.class }} main-page">
        <div class="page-header">
            {% include header-default.html %}
        </div>

        <div class="front-content">
            <div class="wrapperx">
                {{ content }}
            </div>
        </div>

        <script src="/js/imagesloaded.pkgd.min.js"></script>
        <script src="/js/masonry.pkgd.min.js"></script>
        <script src="/js/classie.js"></script>
        <script src="/js/imagemain.js"></script>
        <script>
            (function() {
                // create SVG circle overlay and append it to the preview element
                function createCircleOverlay(previewEl) {
                    var dummy = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                    dummy.setAttributeNS(null, 'version', '1.1');
                    dummy.setAttributeNS(null, 'width', '100%');
                    dummy.setAttributeNS(null, 'height', '100%');
                    dummy.setAttributeNS(null, 'class', 'overlay');
                    var g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                    var circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    circle.setAttributeNS(null, 'cx', 0);
                    circle.setAttributeNS(null, 'cy', 0);
                    circle.setAttributeNS(null, 'r', Math.sqrt(Math.pow(previewEl.offsetWidth,2) + Math.pow(previewEl.offsetHeight,2)));
                    dummy.appendChild(g);
                    g.appendChild(circle);
                    previewEl.appendChild(dummy);
                }
                
                new GridFx(document.querySelector('.grid'), {
                    onInit : function(instance) {
                        createCircleOverlay(instance.previewEl);
                    },
                    onResize : function(instance) {
                        instance.previewEl.querySelector('svg circle').setAttributeNS(null, 'r', Math.sqrt(Math.pow(instance.previewEl.offsetWidth,2) + Math.pow(instance.previewEl.offsetHeight,2)));
                    },
                    onOpenItem : function(instance, item) {
                        // item's image
                        var gridImg = item.querySelector('img'),
                            gridImgOffset = gridImg.getBoundingClientRect(),
                            win = {width: document.documentElement.clientWidth, height: window.innerHeight},
                            SVGCircleGroupEl = instance.previewEl.querySelector('svg > g'),
                            SVGCircleEl = SVGCircleGroupEl.querySelector('circle');
                            
                        SVGCircleEl.setAttributeNS(null, 'r', Math.sqrt(Math.pow(instance.previewEl.offsetWidth,2) + Math.pow(instance.previewEl.offsetHeight,2)));
                        // set the transform for the SVG g node. This will animate the circle overlay. The origin of the circle depends on the position of the clicked item.
                        if( gridImgOffset.left + gridImg.offsetWidth/2 < win.width/2 ) {
                            SVGCircleGroupEl.setAttributeNS(null, 'transform', 'translate(' + win.width + ', ' + (gridImgOffset.top + gridImg.offsetHeight/2 < win.height/2 ? win.height : 0) + ')');
                        }
                        else {
                            SVGCircleGroupEl.setAttributeNS(null, 'transform', 'translate(0, ' + (gridImgOffset.top + gridImg.offsetHeight/2 < win.height/2 ? win.height : 0) + ')');
                        }
                    }
                });
            })();
        </script>

        {% include footer.html %}
        {% include bottom.html %}
    </body>
</html>
